"use strict";angular.module("makerhuntApp",["ngCookies","ngResource","ngSanitize","angularMoment","ui.router"]).config(["$locationProvider","$httpProvider","$stateProvider","$urlRouterProvider",function(a,b,c,d){d.otherwise("/"),a.html5Mode(!0),b.interceptors.push("authInterceptor")}]).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(a,b){return{request:function(a){return a.headers=a.headers||{},a},responseError:function(a){return b.reject(401===a.status?a:a)}}}]).run(["$rootScope","$location","Auth",function(a,b,c){a.$on("$routeChangeStart",function(a,d){c.isLoggedInAsync(function(a){d.authenticate&&!a&&b.path("/login")})})}]),angular.module("makerhuntApp").filter("firstname",function(){return function(a){return a.split(" ")[0]}}),angular.module("makerhuntApp").controller("AdminCtrl",["$scope","Ama",function(a,b){a.action="Add",a.events=[],b.query(function(b){a.events=b}),a.newEvent={},a.searchForUser=function(){console.log(a.newEvent.username),a.newEvent.user={id:12345,username:"levelsio",img_URI:"https://pbs.twimg.com/profile_images/493609499886776320/I66hzR_K.jpeg",maker_of:[{name:"nomadlist",url:"http://link to PH post"}]},a.newEvent.description="I make http://remoteok.io  http://nomadlist.com  http://hashtagnomads.com  http://gofuckingdoit.com  http://tubelytics.com  / 12 startups in 12 months"},a.saveEvent=function(){console.log(a.newEvent),a.newEvent._id||console.log("post"),a.newEvent._id&&(console.log("put"),a.action="Add")},a.editEvent=function(b){a.newEvent=b,a.action="Edit"},a.deleteEvent=function(){}}]),angular.module("makerhuntApp").directive("modal",["$timeout",function(a){return{templateUrl:"app/directives/modal/modal.html",restrict:"A",scope:{response:"=response"},controller:["$scope",function(a){a.isMaker=function(){return angular.isDefined(a.response.user.ph_settings.maker_of_count)?a.response.user.ph_settings.maker_of_count>0:!1}}],link:function(b){console.debug("modal",b),b.modal={},b.modal.button={status:""},b.evaluateModal=function(c){if(b.modalEvaluated===!0)return!1;b.modalEvaluated=!0;var d=c.target;b.isMaker()&&($(d).addClass("busy"),b.modal.button.status="Writing Invitation...",a(function(){b.modal.button.status="Fetching envelope..."},2e3),a(function(){b.modal.button.status="Sending..."},4e3),a(function(){b.modal.button.status="Invite sent!",$(d).removeClass("busy"),$(d).addClass("done")},5e3)),b.isMaker()||"success"!==b.response?b.modal.button.status="On it! Thank you!":($(d).addClass("busy"),b.modal.button.status="Contacting servers...",a(function(){b.modal.button.status="Filling out application..."},2e3),a(function(){b.modal.button.status="Checking lists..."},4e3),a(function(){b.modal.button.status="Success!",$(d).removeClass("busy"),$(d).addClass("done")},5e3))}}}}]),angular.module("makerhuntApp").directive("preload",function(){return{restrict:"A",scope:!1,priority:0,link:function(a,b){b.on("load",function(){b.addClass("fadeIn")})}}}),angular.module("makerhuntApp").controller("MeCtrl",["$scope","$http","utilities","$interval","$timeout","Auth","Event","Maker","user",function(a,b,c,d,e,f,g,h,i){a.response={status:"success",user:i},$("body").addClass("open-overlay"),a.closeModal=function(){$("body").removeClass("open-overlay")}}]),angular.module("makerhuntApp").controller("ErrorCtrl",["$scope","$http","utilities","$interval","$timeout","Auth","Event","Maker",function(a,b,c,d,e,f){a.response={status:"error",user:f.getCurrentUser()},$("body").addClass("open-overlay"),a.closeModal=function(){$("body").removeClass("open-overlay")}}]),angular.module("makerhuntApp").controller("MainCtrl",["$scope","$http","utilities","$interval","$timeout","Auth","Event","Maker",function(a,b,c,d,e,f,g,h){a.currentUser=f.getCurrentUser(),a.state="upcoming",console.log(a.currentUser),a.events=[],g.query(function(b){a.events=b}),a.makers=[],h.query(function(b){var d=c.shuffle(b),e=d.slice(0,60);angular.forEach(e,function(a){this.push(a)},a.makers),a.makerPool=d.slice(60)},function(a){console.log(a)}),d(function(){c.switchUser(a.makers,a.makerPool)},5e3),a.eventsFilter=function(b){return"upcoming"==a.state?moment(b.from_date).isAfter(moment()):"previous"==a.state?moment(b.from_date).isBefore(moment()):!1}}]),angular.module("makerhuntApp").config(["$stateProvider",function(a){a.state("main",{url:"/",views:{main:{templateUrl:"app/main/main.html",controller:"MainCtrl"}}}).state("main:me",{url:"/me",views:{main:{templateUrl:"app/main/main.html",controller:"MainCtrl"},modal:{templateUrl:"app/modals/me.html",controller:"MeCtrl",resolve:{user:["Auth",function(a){return a.getCurrentUser()}]}}}}).state("main:error",{url:"/error",views:{main:{templateUrl:"app/main/main.html",controller:"MainCtrl"},modal:{templateUrl:"app/modals/error.html",controller:"ErrorCtrl"}}})}]),angular.module("makerhuntApp").factory("Auth",["$location","$rootScope","$http","User","$cookies","$q",function(a,b,c,d,e,f){var g={};return angular.isDefined(e.token),g=d.get(),{login:function(a,b){var h=b||angular.noop,i=f.defer();return c.post("/auth/local",{email:a.email,password:a.password}).success(function(a){return e.put("token",a.token),g=d.get(),i.resolve(a),h()}).error(function(a){return this.logout(),i.reject(a),h(a)}.bind(this)),i.promise},logout:function(){e.remove("token"),g={}},createUser:function(a,b){var c=b||angular.noop;return d.save(a,function(b){return e.put("token",b.token),g=d.get(),c(a)},function(a){return this.logout(),c(a)}.bind(this)).$promise},changePassword:function(a,b,c){var e=c||angular.noop;return d.changePassword({id:g._id},{oldPassword:a,newPassword:b},function(a){return e(a)},function(a){return e(a)}).$promise},getCurrentUser:function(){return g},isLoggedIn:function(){return g.hasOwnProperty("role")},isLoggedInAsync:function(a){g.hasOwnProperty("$promise")?g.$promise.then(function(){a(!0)})["catch"](function(){a(!1)}):a(g.hasOwnProperty("role")?!0:!1)},isAdmin:function(){return"admin"===g.role},getToken:function(){return e.get("token")}}}]),angular.module("makerhuntApp").factory("Event",["$resource",function(a){return a("/api/v1/events",{},{query:{method:"GET",isArray:!0,url:"/api/v1/events"},create:{method:"POST",url:"/api/v1/events"},get:{method:"GET",params:{id:""},url:"/api/v1/events/{id}"}})}]),angular.module("makerhuntApp").factory("Maker",["$resource",function(a){return a("/api/v1/makers",{},{query:{method:"GET",isArray:!0},get:{method:"GET"}})}]),angular.module("makerhuntApp").factory("User",["$resource",function(a){return a("/api/v1/me",{},{get:{method:"GET"}})}]),angular.module("makerhuntApp").service("utilities",["$timeout",function(a){return{shuffle:function(a){var b,c,d=a.length;if(d)for(;--d;)c=Math.floor(Math.random()*(d+1)),b=a[c],a[c]=a[d],a[d]=b;return a},switchUser:function(b,c){if(!b.length||!c.length)return!1;var d,e,f,g;f=Math.floor(Math.random()*b.length),g=Math.floor(Math.random()*c.length),d=b[f],e=c[g],$("#"+d.id).addClass("fadeOut"),a(function(){b[f]=e,c[g]=d},1e3)}}}]),angular.module("makerhuntApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.menu=[{title:"Home",link:"/"}],a.isCollapsed=!0,a.isActive=function(a){return a===b.path()}}]),angular.module("makerhuntApp").run(["$templateCache",function(a){a.put("app/admin/admin.html",'<div id=adminView><div class=container><div class=row><div class="offset-by-one ten columns"><h2 class=admin-headline>MakerHunt Admin Interface</h2><h4>{{action}} AMA</h4><form><div class=row><div class="six columns"><label for=username>Username</label><input class=u-full-width placeholder="username (no @)" id=username ng-model=newEvent.username></div><div class="six columns"><input class="button-default btn-search" type=submit value="Search for User" ng-click=searchForUser();></div><div class="twelve columns"><label for=event-date>AMA Date (local time)</label><input class="u-full-width input--event-date" type=datetime-local placeholder="username (no @)" id=event-date ng-model=newEvent.datetime></div></div><label for=description>Description</label><textarea class=u-full-width placeholder="will be pre-filled from twitter bio, but can be changed..." id=description ng-model=newEvent.description></textarea><input class=button-primary type=submit value=Save ng-click=saveEvent();></form></div><!-- AMA LIST START --><div class=amaList><div class=ama-wrapper ng-repeat="ama in events"><div class=row><div class="six columns"><h5 class=ama--timestamp>Mar 10, 2015 at 9:00PM CET</h5></div><div class="six columns"><button class=btn-default ng-click=editEvent(ama);>Edit</button> <button class=btn-warning ng-click=deleteEvent(ama);>Delete</button></div></div><div class=ama><div class=row><div class="twelve columns"><!--<div class="ama--pic--wrapper">--><img class="u-max-full-width ama--pic" ng-src={{ama.ph_profile.image_url}} alt="@{{ama.username}}"><!--</div>\n                <div class="ama--content--wrapper">--><h2 class=ama--maker-name>{{ama.ph_profile.name}} <small class=ama--maker-username><a ng-href=https://twitter.com/{{ama.username}} target=_blank>@{{ama.username}}</a></small></h2><p class=ama--description>{{ama.ph_profile.headline}}</p><!--</div>--><div class=maker-of--wrapper><h6 class=ama--maker-headline ng-show=ama.ph_profile.maker_of.length>Maker</h6><ul class=maker-of-list><li class=maker-of-list--item ng-repeat="product in ama.ph_profile.maker_of"><a ng-href={{product.discussion_url}}>{{product.name}}</a></li></ul></div></div></div></div></div></div><!-- AMA LIST END --></div></div></div>'),a.put("app/directives/modal/modal.html",'<div ng-switch=response.status><div class=modal ng-switch-when=success><div class=modal-img--wrapper><img class=modal-user--pic ng-src="{{response.user.image[\'88px@3X\']}}" alt="{{response.user.username}}"><div class=modal-makerBadge ng-show=isMaker()>M</div></div><h2 class=modal-headline>Hey {{response.user.name | firstname}},</h2><p class=modal-message ng-show=isMaker()>If the email adress below is correct, click to request your invite. If not, click to change it.</p><p class=modal-message ng-show=!isMaker()>It seems like you don\'t have a product on ProductHunt yet. You can still sign up for our newsletter below.</p><input class=modal-input type=email value="{{ response.user.email }}"> <button class=modal-button ng-class="{subscribe : !isMaker()}" ng-click=evaluateModal($event);><span class=spinner><svg version=1.1 x=0 y=0 width=150px height=150px viewbox="-10 -10 120 120" enable-background="new 0 0 200 200" xml:space=preserve><path class=circle d="M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50"></svg></span> <span class=success><svg version=1.1 x=0px y=0px width=611.99px height=611.99px viewbox="0 0 611.99 611.99" enable-background="new 0 0 611.99 611.99" xml:space=preserve><path class=checkMark d="M606.453,101.171c-7.422-7.384-19.436-7.384-26.856,0L209.688,470.353L32.71,293.719c-7.499-7.46-19.626-7.46-27.086,0     c-7.499,7.46-7.499,19.588,0,27.048L195.341,510.14c0.115,0.115,0.306,0.153,0.421,0.269c0.115,0.114,0.153,0.268,0.229,0.382     c7.422,7.422,19.435,7.422,26.856,0l383.605-382.84C613.836,120.566,613.836,108.554,606.453,101.171z"></svg></span> <span class=modal-button-inner ng-show=isMaker() ng-text=modal.button.status>Send Invite</span> <span class=modal-button-inner ng-show=!isMaker() ng-text=modal.button.status>Subscribe</span></button> <a class=modal-secondary-action ng-show=isMaker() href=#>Is this not you? Let us know.</a> <a class=modal-secondary-action ng-show=!isMaker() href=#>Not listed as a Maker yet? Let us know.</a></div><div class=modal ng-switch-when=error><img class=error-illo src=../assets/images/Error_illustration.svg alt="ERROR"><h2 class=modal-headline>Oh...yeah, that\'s no good.</h2><p class=modal-message>It seems like something broke on our side of things. We\'ll look into it right away!</p><button class="modal-button error" ng-click=evaluateModal($event);><span class=spinner><svg version=1.1 x=0 y=0 width=150px height=150px viewbox="-10 -10 120 120" enable-background="new 0 0 200 200" xml:space=preserve><path class=circle d="M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50"></svg></span> <span class=success><svg version=1.1 x=0px y=0px width=611.99px height=611.99px viewbox="0 0 611.99 611.99" enable-background="new 0 0 611.99 611.99" xml:space=preserve><path class=checkMark d="M606.453,101.171c-7.422-7.384-19.436-7.384-26.856,0L209.688,470.353L32.71,293.719c-7.499-7.46-19.626-7.46-27.086,0     c-7.499,7.46-7.499,19.588,0,27.048L195.341,510.14c0.115,0.115,0.306,0.153,0.421,0.269c0.115,0.114,0.153,0.268,0.229,0.382     c7.422,7.422,19.435,7.422,26.856,0l383.605-382.84C613.836,120.566,613.836,108.554,606.453,101.171z"></svg></span> <span class=modal-button-inner>Report this to us!</span></button></div></div>'),a.put("app/main/main.html",'<div id=mainView><div class=makerFaces><img preload id={{maker.id}} class="makerFaces-face animated" ng-src={{maker.profile.image_192}} ng-repeat="maker in makers" alt=""></div><nav><div class=container><div class=row><div class="twelve columns"><ul><li><a href=#>Contributors</a></li><li><a href=#>Contact</a></li></ul></div></div></div></nav><header><div class=container><div class=row><div class="offset-by-two eight columns"><h1 class=logo>Maker Hunt</h1><h3 class=tagline>The slack chat for product driven makers from the Product Hunt community</h3><a href=/login target=_self class=btn-requestInvite>Request Invite</a> <a href=/login target=_self class=login-with-PH>Login with ProductHunt</a></div></div></div></header><section class=main><div class=container><div class=row><div class="offset-by-two eight columns"><h2 class=amas-headline>Our Maker AMA\'s</h2><h4 class=amas-tagline>From product and business to work-life balance,<br>come ask the makers anything</h4></div></div><div class=row><div class="twelve columns"><div class=switch-wrapper><button class="btn-amas btn-amas--upcoming active" data-ng-class="{&quot;active&quot;: state==&quot;upcoming&quot;}" ng-click="state = &quot;upcoming&quot;;">upcoming</button> <button class="btn-amas btn-amas--previous" data-ng-class="{&quot;active&quot;: state==&quot;previous&quot;}" ng-click="state = &quot;previous&quot;;">previous</button></div></div></div><div class=row><div class="offset-by-one ten columns"><div class=amaList><div class=ama-wrapper ng-repeat="event in events | filter:eventsFilter"><div class=row><div class="six columns"><h5 class=ama--timestamp>{{event.from_date | amDateFormat:\'dddd, MMMM Do YYYY, h:mm:ss a\'}}</h5></div><div class="six columns"><div class=action-menu><a ng-href=# class="action-item twitter"><i class="fa fa-twitter"></i></a> <a ng-href=# class="action-item facebook"><i class="fa fa-facebook-official"></i></a> <a ng-href=# class="action-item calendar"><i class="fa fa-calendar-o"></i></a></div></div></div><div class=ama><div class=row><div class="twelve columns"><!--<div class="ama--pic--wrapper">--><img class="u-max-full-width ama--pic" ng-src={{event.ph_profile.image_url}} alt="@{{event.username}}"><!--</div>\n                    <div class="ama--content--wrapper">--><h2 class=ama--maker-name>{{event.ph_profile.name}} <small class=ama--maker-username><a ng-href=https://twitter.com/{{event.username}} target=_blank>@{{event.username}}</a></small></h2><p class=ama--description>{{event.ph_profile.headline}}</p><!--</div>--><div class=maker-of--wrapper><h6 class=ama--maker-headline ng-show=event.ph_profile.maker_of.length>Maker</h6><ul class=maker-of-list><li class=maker-of-list--item ng-repeat="product in event.ph_profile.maker_of"><a ng-href={{product.discussion_url}}>{{product.name}}</a></li></ul></div></div></div></div></div></div></div></div></div></section></div>'),a.put("app/modals/error.html","<div class=overlay ng-click=closeModal();><div modal response=response ng-click=$event.stopPropagation();></div></div>"),a.put("app/modals/me.html","<div class=overlay ng-click=closeModal();><div modal response=response ng-click=$event.stopPropagation();></div></div>"),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>makerhunt</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li></ul></div></div></div>')}]);